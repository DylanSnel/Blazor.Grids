@using System.Globalization

@if (Header != null)
{
    <div @onmousemove="MovingAsync" @onmouseup="MouseUpAsync"
         style="position: absolute; background-color: #19c5e388;
                left: @(X.ToString(CultureInfo.InvariantCulture) + "px");
                top: @(Y.ToString(CultureInfo.InvariantCulture) + "px");
                width: @(Width.ToString(CultureInfo.InvariantCulture) + "px");
                height: @(Height.ToString(CultureInfo.InvariantCulture) + "px");" />
}
@code {
    private double X { get; set; }
    private double Y { get; set; }
    private double Width { get; set; }
    private double Height { get; set; }
    internal void SetPosition(double x, double y)
    {
        (X, Y) = (x, y);
        StateHasChanged();
    }
    private Header Header { get; set; }
    internal void SetHeader(Header header)
    {
        Header = header;
        StateHasChanged();
    }
    internal void SetSize(double width, double height)
    {
        (Width, Height) = (width, height);
        StateHasChanged();
    }
    private bool render_required = true;
    private Task MovingAsync(MouseEventArgs e)
    {
        render_required = false;
        return Header?.MovingAsync(e) ?? Task.CompletedTask;
    }
    private Task MouseUpAsync(MouseEventArgs e)
    {
        render_required = false;
        return Header?.MouseUpAsync(e) ?? Task.CompletedTask;
    }
    protected override bool ShouldRender()
    {
        if (!render_required)
        {
            render_required = true;
            return false;
        }
        return base.ShouldRender();
    }
} 